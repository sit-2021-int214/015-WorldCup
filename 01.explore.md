# WorldCup
Dataset from : https://raw.githubusercontent.com/sit-2021-int214/015-WorldCup/master/worldcupclean.csv

## My Step
1. Define a question
2. Search datasets from Kaggle
3. Download Library and dataset
4. Explore the dataset from the original dataset
5. Cleaning Dataset
6. Exploratory Data Analysis

# Defind a question
1. คู่ไหนที่ทีมเหย้าและทีมเยือน ยิงประตูในครึ่งหลังรวมกันเกิน 4 ลูก
2. สนามไหนที่ใช้ในการจัดแข่งขันบอลโลกทั้งหมด 10 ครั้ง
3. ผลรวมของจำนวนประตูในครึ่งแรก และ ผลรวมของจำนวนประตูในครึ่งหลัง ในปี 1930 มีค่าเท่าไหร่
4. การแข่งขันฟุตโลกในปีไหนที่มีผู้เข้ารับชมเกิน 100,000 คน
5. ในการแข่งขันปีไหนที่มีจำนวนการยิงประตูรวมมากที่สุด

# Step 0 Loading library and dataset
```{R}
#library
library(readr)
library(stringr)
library(dplyr)

#Dataset
read_csv("https://raw.githubusercontent.com/sit-2021-int214/015-WorldCup/master/worldcupclean.csv")
worldcup <- read_csv("https://raw.githubusercontent.com/sit-2021-int214/015-WorldCup/master/worldcupclean.csv")
View(worldcup)
```

### 1.) คู่ไหนที่ทีมเหย้าและทีมเยือน ยิงประตูในครึ่งหลังรวมกันเกิน 4 ลูก
```{R}
halfGoals <- worldcup %>% 
  distinct() %>% 
  select(Datetime,Home.Team.Name,Half.time.Home.Goals,Away.Team.Name,Half.time.Away.Goals) %>% 
  rename(Home.Team.Goals = Half.time.Home.Goals,Away.Team.Goals = Half.time.Away.Goals) %>% 
  filter(Away.Team.Goals + Home.Team.Goals > 4)
halfGoals <- halfGoals %>% 
  mutate(Total.Goals = Home.Team.Goals + Away.Team.Goals)
View(halfGoals)
```
### Result : 
```{R}
Datetime             Home.Team.Name  Home.Team.Goals  Away.Team.Name  Away.Team.Goals  Total.Goals
26/6/1954 17:00      Austria               5          Switzerland            4             9
23/7/1966 15:00      Portugal              2          Korea DPR              3             5
18/6/1974 19:30      Yugoslavia            6          Zaire                  0             6
19/6/1974 19:30      Haiti                 0          Poland                 5             5
8/7/2014 17:00       Brazil                0          Germany                5             5
```


### 2.) สนามไหนที่ใช้ในการจัดแข่งขันบอลโลกทั้งหมด 10 ครั้ง
```{R}
factor(worldcup$Stadium) 
stadium <- factor(worldcup$Stadium) 
summary(stadium) 
which(summary(stadium)==10)
```
### Result : สนามที่ใช้ในการแข่งขันทั้งหมด 10 ครั้งคือสนาม Estadio Centenario , สนาม Estadio do Maracana , สนาม Estadio Nacional , สนาม Nacional
```{R}
Estadio Centenario / Estadio do Maracana / Estadio Nacional / Nacional                                                                        
```

### 3.) ผลรวมของจำนวนประตูในครึ่งแรก และ ผลรวมของจำนวนประตูในครึ่งหลัง ในปี 1930 มีค่าเท่าไหร่
```{R}
totalGoals <- worldcup %>% 
  select(Year,Home.Team.Goals,Half.time.Home.Goals) %>% 
  filter(worldcup$Year == 1930) %>% 
  summarise(sum.Home.Team.1930 = sum(Home.Team.Goals), 
            sum.Half.Time.Home.Team.1930 = sum(Half.time.Home.Goals))
View(totalGoals)
```
### Result :
```{R}
sum.Home.Team.1930 || sum.Half.Time.Home.Team.1930
                59                              27
```
### 4.) การแข่งขันฟุตโลกในปีไหนที่มีผู้เข้ารับชมเกิน 100,000 คน
```{R}
Attendance <- worldcup %>% 
  select(Year, Home.Team.Name, Away.Team.Name, Attendance)%>%filter(Attendance > 100000)
View(Attendance)
```
### Result :
```{R}	
    Year      Home.Team.Name  Away.Team.Name   Attendance
1   1950      Brazil          Yugoslavi        142429
2   1950      Brazil          Sweden           138886
3   1950      Brazil          Spain            152772
4   1950      Uruguay         Brazil           173850
5   1970      Mexico          Soviet Union     107160
6   1970      Mexico          El Salvador      103058
7   1970      Mexico          Belgium          108192
8   1970      Italy           Germany FR       102444
9   1970      Germany FR      Uruguay          104403
10  1970      Brazil          Italy            107412
11  1986      Belgium         Mexico           110000
12  1986      Mexico          Paraguay         114600
13  1986      Iraq            Mexico           103763
14  1986      Mexico          Bulgaria         114580
15  1986      Argentina       England          114580
16  1986      Argentina       Belgium          114500
17  1986      Argentina       Germany FR       114600
```
### 5.) ในการแข่งขันปีไหนที่มีจำนวนการยิงประตูรวมมากที่สุด
```{R}
maximumGoals <- worldcup %>% 
  mutate(Total.Goals = worldcup$Home.Team.Goals + worldcup$Away.Team.Goals + worldcup$Half.time.Home.Goals + worldcup$Half.time.Away.Goals)
maximumGoals <- maximumGoals %>% 
  group_by(Year) %>% 
  summarise(Goals = sum(Total.Goals))
maximumGoals <- maximumGoals %>% 
  filter(Goals == max(Goals))
View(maximumGoals)
```
### Result :
```{R}
     Year  Goals
1    2014   280
```

